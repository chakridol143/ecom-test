<div class="container">
  <div class="top-bar"></div>

  <!-- <h2>All Products</h2> -->

  <div *ngIf="loading">Loadingâ€¦</div>
  <div *ngIf="!loading && error" class="error">{{ error }}</div>

  
  <div *ngIf="!loading && !error">
    <div class="product-grid" *ngIf="productsToShow.length; else empty">
      <div class="product-card" *ngFor="let product of productsToShow">
        <img
          [src]="'http://localhost:3000/assets/images/' + product.image_url"
          [alt]="product.name"
          class="product-img"
          (click)="openProductPopup(product)"
          (error)="onImgError($event)"
        />
        <div class="product-info">
          <h3>{{ product.name }}</h3>
          <p>{{ product.description }}</p>
          <p class="price">{{ product.price | currency:'INR':'symbol':'1.2-2' }}</p>
          <button (click)="addToCart(product)">Add To Cart</button>
        </div>
      </div>
    </div>

    <ng-template #empty>
      <p>No products found.</p>
    </ng-template>
  </div>
</div>

<!-- Login Prompt Dialog -->
<div class="modal-overlay" *ngIf="showLoginDialog" (click)="closeLoginDialog()"></div>

<div class="login-dialog" *ngIf="showLoginDialog" (click)="closeLoginDialog()">
  <div class="dialog-box">
    <h2>Login Required</h2>
    <p>You need to log in to add items to your cart.</p>

    <div class="dialog-actions">
      <button class="login-btn" (click)="goToLogin()">Login</button>
      <button class="cancel-btn" (click)="closeLoginDialog()">Cancel</button>
    </div>
  </div>
</div>


<!-- ðŸ”¥ PRODUCT DETAILS POPUP -->
<div class="modal-overlay" *ngIf="showProductPopup" (click)="closeProductPopup()"></div>

<div class="product-popup" *ngIf="showProductPopup">
  <div class="popup-box" (click)="$event.stopPropagation()">

    <button class="popup-close" (click)="closeProductPopup()">âœ–</button>

    <img
      class="popup-img"
      [src]="'http://localhost:3000/assets/images/' + selectedProducts?.image_url"

      alt="Product"
      (error)="onImgError($event)"
    />

    <h2>{{ selectedProducts?.name }}</h2>
    <p class="popup-desc">{{ selectedProducts?.description }}</p>

    <h3 class="popup-price">
      Price: {{ selectedProducts?.price | currency:'INR':'symbol':'1.2-2' }}
    </h3>

    <!-- <button class="popup-add-btn" (click)="addToCart(selectedProducts)">Add To Cart</button> -->
  </div>
</div>


<app-footer></app-footer>